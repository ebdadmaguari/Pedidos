<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedido de Revistas - Escola Bíblica Dominical</title>
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
     <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
      :root {
  --primary: #305aa3;
  --border-color: #000;
  --background: #fff;
  --row-blue: #cce0ff;
  --row-orange: #ffe4cc;
  --row-green: #d4edda;
  --text-color: #333;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: Arial, sans-serif;
  padding: 20px;
  background: var(--background);
  color: var(--text-color);
  line-height: 1.4;
}

.container {
  max-width: 1000px;
  margin: 0 auto;
  background: white;
  padding: 20px;
  border: 1px solid var(--border-color);
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

.header {
  text-align: center;
  margin-bottom: 20px;
  border-bottom: 2px solid var(--primary);
  padding-bottom: 15px;
}

/* Layout para DESKTOP (telas maiores) */
.cabecalho {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 20px;
  margin-bottom: 30px;
}

.container-logos {
  display: flex;
  gap: 40px;
}

.logo img {
  max-width: 120px;
  height: auto;
}

.texto-central {
  flex: 1;
  text-align: center;
  padding: 0 20px;
}

/* Layout para MOBILE (telas menores) */
@media (max-width: 768px) {
  .cabecalho {
    flex-direction: column;
    gap: 15px;
  }

  .container-logos {
    order: -1; /* Garante que fique acima do texto */
    margin-bottom: 15px;
    gap: 20px;
  }

  .logo img {
    max-width: 100px; /* Reduz um pouco o tamanho em mobile */
  }

  .texto-central {
    padding: 0 10px;
  }

  .texto-central h1 {
    font-size: 16px;
  }

  .texto-central p {
    font-size: 12px;
  }
}

/* Responsividade para mobile */
@media (max-width: 768px) {
  .logos-linha {
    gap: 20px;
  }
  
  .logo img {
    max-width: 100px;
  }
  
  .texto-central h1 {
    font-size: 16px;
  }
  
  .texto-central p {
    font-size: 12px;
  }
}
.header-title {
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 8px;
}

.header-info {
  font-size: 14px;
  margin-bottom: 4px;
}

.form-header {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-bottom: 5px;
}

.form-group {
  margin-bottom: 2px;
}

.form-group label {
  display: block;
  font-weight: bold;
  margin-bottom: 5px;
  font-size: 14px;
}

input[type="text"],
input[type="tel"],
input[type="number"],
input[type="date"] {
  width: 100%;
  padding: 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  font-size: 14px;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 25px;
}

th, td {
  border: 1px solid var(--border-color);
  padding: 8px;
  text-align: left;
  font-size: 13px;
}

th {
  background-color: var(--primary);
  color: white;
  font-weight: bold;
}

.category-header {
  background-color: var(--primary);
  color: white;
  text-align: center;
  font-weight: bold;
  padding: 10px;
}

.row-blue {
  background-color: var(--row-blue);
}

.row-orange {
  background-color: var(--row-orange);
}

.row-green {
  background-color: var(--row-green);
}

.qty-input {
  width: 70px;
  text-align: center;
  padding: 6px;
  border: 1px solid #ccc;
  border-radius: 4px;
}

.payment-section {
  margin-top: 30px;
  border: 1px solid #ddd;
  padding: 20px;
  border-radius: 4px;
  background-color: #f9f9f9;
}

.payment-table {
  margin-bottom: 15px;
}

.payment-note {
  color: #dc3545;
  font-size: 13px;
  margin-top: 15px;
  font-weight: bold;
}

.observations {
  margin: 30px 0;
}

.observations textarea {
  width: 100%;
  height: 120px;
  border: 1px solid var(--border-color);
  padding: 12px;
  border-radius: 4px;
  resize: vertical;
}

.signatures {
  display: flex;
  justify-content: space-between;
  margin: 50px 0;
}

.signature-line {
  width: 250px;
  text-align: center;
}

.signature-line hr {
  margin-bottom: 8px;
  border: none;
  border-top: 1px solid var(--border-color);
}

.secretary-section {
  margin-top: 30px;
  border-top: 2px solid var(--primary);
  padding-top: 25px;
}

.action-buttons {
  display: flex;
  justify-content: center;
  gap: 15px;
  margin-top: 30px;
}

.btn {
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-weight: bold;
  font-size: 14px;
  transition: all 0.3s ease;
}

.btn-primary {
  background-color: var(--primary);
  color: white;
}

.btn-primary:hover {
  background-color: #264a87;
}

.btn-outline {
  border: 2px solid var(--primary);
  background-color: white;
  color: var(--primary);
}

.btn-outline:hover {
  background-color: #f0f4f9;
}

.tabela-scroll {
  width: 100%;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch; /* Melhora o scroll em dispositivos móveis */
}

.tabela-scroll table {
  min-width: 800px;
  border-collapse: collapse;
}

/* Estilos específicos para mobile */
@media (max-width: 768px) {
  .container {
    padding: 10px;
  }
  
  .cabecalho {
    flex-direction: column;
    gap: 10px;
  }

  .logo {
    flex-direction: row;
    gap: 10px;
  }

  .logo img {
    width: 100px;
  }

  .texto-central {
    font-size: 14px;
    max-width: 90%;
  }

  .texto-central h1 {
    font-size: 16px;
  }

  .texto-central p {
    font-size: 13px;
  }

  .form-header {
    grid-template-columns: 1fr;
  }

  th, td {
    padding: 4px 6px;
    font-size: 12px;
  }

  .qty-input {
    width: 50px;
    padding: 4px;
  font-size: 12px;
  }

  .category-header {
    padding: 6px;
    font-size: 12px;
  }

  .action-buttons {
    flex-direction: column;
    gap: 10px;
  }

  .btn {
    width: 100%;
    padding: 8px;
  }

  input[type="text"],
  input[type="tel"],
  input[type="number"],
  input[type="date"] {
    padding: 6px;
    font-size: 13px;
  }
}

@media (min-width: 768px) {
  .logos-juntas {
    justify-content: space-between;
  }
  
  .texto-central {
    flex: 1;
    text-align: center;
    margin: 0 10px;
  }
}
    </style>
  </head>
  <body>
    <div class="cabecalho">
  <div class="logo logo-esquerda">
    <img src="c:\Users\midia\Downloads\Cópia de AEG - (080) (4).png" alt="Logo Esquerda">
  </div>

  <!-- Texto abaixo das logos -->
  <div class="texto-central">
    <h1>IGREJA EVANGÉLICA ASSEMBLEIA DE DEUS - CAMPO NO MAGUARI</h1>
    <p>DEPARTAMENTO DA ESCOLA BÍBLICA DOMINICAL<br>
    CNPJ: 15.296.627/0001-09<br>
    Templo Central: Av. Cláudio Sanders, Nº 02, Maguari - ANANINDEUA-PA<br>
    Pr. Presidente: Wilson Marques Vicente<br>
    Superintendente: Midian e Álvaro Rodrigues</p>
  </div>

  <div class="logo logo-direita">
    <img src="c:\Users\midia\Downloads\Cópia de AEG - (080) (8).png" alt="Logo Direita">
  </div>
</div>


<div class="tabela-scroll">
  <table>
    <!-- conteúdo da tabela -->
  

      <h2 style="text-align: center; margin: 20px 0;">PEDIDO DE REVISTAS - <span id="trimester">TRIMESTRE 202_</span></h2>

      <div class="form-header">
        <div class="form-group">
          <label>CONGREGAÇÃO:</label>
          <input type="text" id="congregation">
        </div>
        <div class="form-group">
          <label>GRUPO:</label>
          <input type="text" id="group">
        </div>
        <div class="form-group">
          <label>COORDENADOR(A):</label>
          <input type="text" id="coordinator">
        </div>
        <div class="form-group">
          <label>FONE:</label>
          <input type="tel" id="phone">
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <th rowspan="2">VALORES</th>
            <th rowspan="2">MATERIAL</th>
            <th rowspan="2">ALUNO</th>
            <th rowspan="2">PROFESSOR</th>
            <th colspan="2" style="text-align: center;">KIT VISUAIS + PROFESSOR</th>
          </tr>
          <tr>
            <th>QUANTIDADE</th>
            <th>SUBTOTAL R$</th>
          </tr>
        </thead>
        <tbody>
          <!-- CRIANÇAS -->
          <tr>
            <td colspan="6" class="category-header">CRIANÇAS</td>
          </tr>
          <tr class="row-blue">
            <td rowspan="4">
              Criança: R$ 8,00<br>
              Professor: R$ 15,00<br>
              Kit: R$ 45,00
            </td>
            <td>Maternal (3/4 anos)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="8"></td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="15"></td>
            <td><input type="number" class="qty-input" data-type="kit" data-price="45"></td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-blue">
            <td>Jard. Infância (5/6 anos)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="8"></td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="15"></td>
            <td><input type="number" class="qty-input" data-type="kit" data-price="45"></td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-blue">
            <td>Primário (7/8 anos)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="8"></td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="15"></td>
            <td><input type="number" class="qty-input" data-type="kit" data-price="45"></td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-blue">
            <td>Juniores (9/10 anos)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="8"></td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="15"></td>
            <td><input type="number" class="qty-input" data-type="kit" data-price="45"></td>
            <td class="subtotal">R$ 0,00</td>
          </tr>

          <!-- ADOLESCENTES E JOVENS -->
          <tr>
            <td colspan="6" class="category-header">ADOLESCENTES E JOVENS</td>
          </tr>
          <tr class="row-orange">
            <td rowspan="4">
              Aluno: R$ 10,00<br>
              Professor: R$ 15,00
            </td>
            <td>Pré-Adolescentes (11/12 anos)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="10"></td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="15"></td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-orange">
            <td>Adolescentes (13/14 anos)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="10"></td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="15"></td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-orange">
            <td>Juvenis (15/17 anos)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="10"></td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="15"></td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-orange">
            <td>Jovem (normal)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="10"></td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="15"></td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>

          <!-- ADULTOS -->
          <tr>
            <td colspan="6" class="category-header">ADULTOS</td>
          </tr>
          <tr class="row-orange">
            <td rowspan="2">
              Aluno: R$ 10,00<br>
              Professor: R$ 15,00
            </td>
            <td>Adultos (normal)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="10"></td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="15"></td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-orange">
            <td>Discipulado (normal)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="10"></td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="15"></td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>

          <!-- MATERIAIS ADICIONAIS -->
          <tr>
            <td colspan="6" class="category-header">MATERIAIS ADICIONAIS</td>
          </tr>
          <tr class="row-green">
            <td>R$ 17,00</td>
            <td>Letra gigante Aluno</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="17"></td>
            <td>——</td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-green">
            <td>R$ 20,00</td>
            <td>Letra gigante Professor</td>
            <td>——</td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="20"></td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-green">
            <td>R$ 30,00</td>
            <td>Adultos (capa dura)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="30"></td>
            <td>——</td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-green">
            <td>R$ 20,00</td>
            <td>Livro de apoio (Jovens)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="20"></td>
            <td>——</td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-green">
            <td>R$ 20,00</td>
            <td>Livro de apoio (Adulto)</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="20"></td>
            <td>——</td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-green">
            <td>R$ 15,00</td>
            <td>Ensinador Cristão</td>
            <td>——</td>
            <td><input type="number" class="qty-input" data-type="teacher" data-price="15"></td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-green">
            <td>R$ 5,00</td>
            <td>Caderneta de Chamada</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="5"></td>
            <td>——</td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>
          <tr class="row-green">
            <td>R$ 15,00</td>
            <td>Livro de Relatório</td>
            <td><input type="number" class="qty-input" data-type="student" data-price="15"></td>
            <td>——</td>
            <td>——</td>
            <td class="subtotal">R$ 0,00</td>
          </tr>

          <!-- Total -->
          <tr>
            <td colspan="5" style="text-align: right; font-weight: bold;">TOTAL ATUALIZADO:</td>
            <td id="total" style="font-weight: bold;">R$ 0,00</td>
          </tr>
        </tbody>
      </table>
          </tbody>
        </table>
        
      <div class="action-buttons">
        <button class="btn btn-outline" onclick="resetForm()">Limpar Formulário</button>
        <button class="btn btn-primary" onclick="calculateTotal()">Calcular Total</button>
        <button class="btn btn-primary" onclick="generateAndSharePDF()">Enviar por WhatsApp</button>

      </div>
    </div>
</table>
</div>

    <script>
   document.addEventListener('DOMContentLoaded', function() {
    // Configuração inicial do trimestre
    const now = new Date();
    const year = now.getFullYear();
    const month = now.getMonth();
    const trimester = ["1º", "2º", "3º", "4º"][Math.floor(month / 3)];
    document.getElementById('trimester').textContent = `${trimester} TRIMESTRE ${year}`;

    // Eventos nos campos de quantidade
    document.querySelectorAll('.qty-input').forEach(input => {
        input.addEventListener('input', calculateSubtotals);
    });

    // Função principal de cálculo
    function calculateSubtotals() {
        let grandTotal = 0;
        
        document.querySelectorAll('table tbody tr').forEach(row => {
            if (row.classList.contains('category-header') || row.querySelector('td[colspan]')) return;
            
            let rowTotal = 0;
            const inputs = row.querySelectorAll('.qty-input');
            
            inputs.forEach(input => {
                const quantity = parseInt(input.value) || 0;
                const price = parseFloat(input.dataset.price) || 0;
                rowTotal += quantity * price;
            });
            
            const subtotalCell = row.querySelector('.subtotal');
            if (subtotalCell) {
                subtotalCell.textContent = formatCurrency(rowTotal);
                grandTotal += rowTotal;
            }
        });
        
        document.getElementById('total').textContent = formatCurrency(grandTotal);
    }

    // Formatação monetária
    function formatCurrency(value) {
        return 'R$ ' + value.toFixed(2).replace('.', ',').replace(/(\d)(?=(\d{3})+\,)/g, '$1.');
    }

    // Gerar PDF e enviar para WhatsApp específico
    window.enviarParaWhatsapp = function() {
        // Primeiro calcula os totais
        calculateSubtotals();
        
        // Configurações do PDF
        const element = document.getElementById('form-container');
        const opt = {
            margin: 10,
            filename: `Pedido_Revistas_${trimester}_Trimestre_${year}.pdf`,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { 
                scale: 2,
                logging: true,
                useCORS: true
            },
            jsPDF: { 
                unit: 'mm', 
                format: 'a4', 
                orientation: 'portrait' 
            }
        };

        // Gera o PDF
        html2pdf().set(opt).from(element).toPdf().get('pdf').then(function(pdf) {
            const pdfBlob = pdf.output('blob');
            const pdfUrl = URL.createObjectURL(pdfBlob);
            
            // Dados para mensagem
            const congregation = document.getElementById('congregation').value || 'Não informado';
            const total = document.getElementById('total').textContent;
            
            // Mensagem personalizada
            const message = `*PEDIDO DE REVISTAS*\n\n` +
                          `*Congregação:* ${congregation}\n` +
                          `*Trimestre:* ${trimester} Trimestre ${year}\n` +
                          `*Total:* ${total}\n\n` +
                          `Anexo: Pedido completo em PDF`;
            
            // Link direto para seu WhatsApp
            const whatsappUrl = `https://wa.me/91981918866?text=${encodeURIComponent(message)}`;
            
            // Cria link para download do PDF
            const a = document.createElement('a');
            a.href = pdfUrl;
            a.download = opt.filename;
            document.body.appendChild(a);
            a.click();
            
            // Abre WhatsApp após 1 segundo
            setTimeout(() => {
                window.open(whatsappUrl, '_blank');
                document.body.removeChild(a);
                URL.revokeObjectURL(pdfUrl);
            }, 1000);
            
        }).catch(err => {
            console.error('Erro ao gerar PDF:', err);
            alert('Erro ao gerar PDF. Por favor, tente novamente.');
        });
    };
});
    </script>
  </body>
</html>